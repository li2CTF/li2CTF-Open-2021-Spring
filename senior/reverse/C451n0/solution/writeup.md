# C451n0 writeup
The program is a casino simulator. After getting offer to "earn 200 coins and leave", we need to try to do it. The casino works on pseudo-random algo. So, we can easily predict numbers. Write the code, which will calculate sequence of numbers (`get_pseudorandom_sequence.c`), ctrl+c + ctrlc+v. We got 200 coins. After that stranger sells secret data to us and asks for the last number we typed in casino. The last one is 8. Then we see trolling message - it means nothing, there are no secrets. Let's dig deeper.

Looking at all functions (as conditions adviced us), we may notice that there is a function called `pr1ntR34lPr1z3()` After analysis we may cocnlude that function isn't called anywhere and has no atributes. That means that function is independent. So, we need to find the way to call it. The best way is a binary patching. For example, we can change `0x0000285E` assembly line (which calls `printBanner()`). So, we can patch it using IDA Pro (just apply binary patch, changing line to `call    pr1ntR34lPr1z3`) or, if we don't have IDA Pro, we can do it by ourselves. The only thing we need to know is that `call` instruction opcode is `E8 <4-bytes OFFSET>`, where `OFFSET = FUNCTION_ADDRESS - CALL_ADDRESS`. In our example `CALL_ADDRESS = 0x0000285E + 5 = 0x00002863` (5 is a length of the command `call`) and `FUNCTION_ADDRESS = 0x00002900` (`pr1ntR34lPr1z3`'s address). So, the `OFFSET` is `0x0000009D` (`0x00002900 - 0x00002863 = 0x0000009D`). Don't forget about little endian. Finally, we just replace instruction on the 0x000014D0 (`E8 9D FF FF FF`) with our new instruction (`E8 9D 00 00 00`).

No difference how you've made a patch, after running program we see the flag.

Flag: **flag{17_mu57_533m_l1k3_4n_18-c4r47_run_0f_b4d_4773mp75,_huh?}**
