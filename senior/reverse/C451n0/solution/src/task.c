#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>

int m0n3y = 100;
int xorKey = 0xFACE;
int syms[] = {1, 3, 2, 2, 5, 5, 3, 1, 4, 1, 4, 2, 3, 1, 1, 2, 3, 2, 3, 1, 2, 3, 2, 2, 3, 1, 3, 3, 3, 5, 2, 2, 1, 2, 2, 4, 3, 1, 3, 3, 3, 5, 1, 5, 2, 2, 2, 4, 4, 1, 2, 2, 3, 4, 4, 3, 4, 2, 3, 1, 1};
int numsLength = 0x131;
int nums[] = {256816, 256752, 256724, 256740, 256728, 257084, 256780, 257100, 256756, 256808, 256836, 256832, 256660, 256804, 257096, 256760, 256820, 256812, 257100, 256760, 256796, 257076, 256660, 256768, 256728, 256764, 256732, 256828, 256844, 256804, 256820, 257084, 256832, 257076, 256828, 256720, 256660, 257084, 257092, 256828, 257092, 256752, 256836, 256732, 257096, 256660, 256808, 256812, 256728, 257100, 256824, 256740, 256844, 256740, 257092, 256796, 256660, 256844, 257080, 257100, 256740, 256720, 256660, 256812, 256824, 257100, 256828, 256820, 257064, 256780, 256832, 256988, 257080, 256780, 256768, 256736, 256772, 256724, 257080, 256824, 256832, 257080, 256772, 257076, 256816, 256660, 256728, 256832, 256756, 256832, 256724, 256740, 256828, 256720, 256740, 256732, 256660, 257100, 256724, 257096, 256836, 256768, 256752, 256836, 257092, 256804, 256844, 256660, 256768, 256780, 256836, 256748, 256824, 257080, 257092, 256760, 256820, 256660, 256740, 257080, 257084, 256760, 256736, 257076, 256736, 256772, 256836, 257076, 257092, 256728, 256732, 256728, 256840, 256780, 256732, 257076, 256764, 256728, 256724, 257084, 256824, 256760, 256844, 256984, 256832, 256736, 256660, 256756, 256804, 256844, 256744, 256660, 256828, 256780, 256732, 256744, 257044, 256796, 256756, 256828, 256804, 256804, 256748, 256820, 256844, 256816, 256808, 257080, 256820, 256812, 256756, 256840, 256748, 256840, 256748, 256780, 256816, 256756, 256736, 256752, 256812, 256728, 256720, 256808, 256840, 256752, 256812, 257100, 256816, 256740, 257100, 256752, 256724, 256720, 256812, 256732, 256816, 256732, 256768, 256840, 256844, 257096, 256728, 256824, 256660, 256740, 256812, 256804, 256800, 257100, 256760, 257080, 256752, 257084, 256744, 256768, 256824, 256756, 256836, 256756, 256800, 256756, 256796, 256780, 256824, 256744, 256768, 256760, 256816, 256780, 256744, 256844, 257080, 256828, 257084, 256804, 256744, 256724, 256720, 256836, 257084, 257080, 256728, 256748, 256744, 256740, 256844, 256740, 256824, 257084, 257080, 256764, 257100, 256728, 256732, 257096, 256768, 256756, 256820, 256744, 256720, 256780, 256772, 256820, 256760, 256796, 256828, 256736, 256744, 256816, 256836, 256752, 256760, 256732, 257100, 256844, 256756, 256760, 256744, 256828, 256728, 256820, 256840, 256828, 256836, 256744, 256748, 256796, 257092, 257084, 256752, 256824, 256800, 256744, 256736, 256836, 256836, 256764, 256772, 257084, 256808, 256760, 256816, 256744, 256832};
unsigned int seed = 0;
const int prizeLength = 204;
const char prize_encoded[] = {-17, 29, 13, 27, 27, -56, 31, 16, 23, -49, 27, -56, 31, 9, 19, 17, 22, 15, -56, 29, 24, -56, 23, 30, 13, 26, -56, 16, 13, 26, 13, -25, -78, -78, 1, 23, 29, -49, 30, 13, -56, 21, 9, 12, 13, -56, 33, 23, 29, 26, -56, 28, 9, 27, 19, -44, -56, 19, 17, 12, -42, -56, -20, 17, 12, -56, 33, 23, 29, -56, 26, 13, 9, 20, 20, 33, -56, 28, 16, 17, 22, 19, -56, 33, 23, 29, -56, 11, 9, 22, -56, 18, 29, 27, 28, -56, 31, 26, 17, 28, 13, -56, -37, -56, 20, 17, 22, 13, 27, -56, 23, 22, -56, 24, 33, 28, 16, 23, 22, -56, 9, 22, 12, -56, 15, 13, 28, -56, 33, 23, 29, 26, -56, 14, 20, 9, 15, -25, -56, -10, 23, -42, -56, -4, 26, 29, 28, 16, -56, 17, 27, -42, -42, -42, -56, 28, 16, 13, -56, 15, 9, 21, 13, -56, 31, 9, 27, -56, 26, 17, 15, 15, 13, 12, -56, 14, 26, 23, 21, -56, 28, 16, 13, -56, 27, 28, 9, 26, 28, -42, -56, -17, 23, 23, 12, 10, 33, 13, -44, -56, 19, 17, 12, -42};

unsigned int r4nd0m(unsigned int prev) {
    return prev * 1664523U + 1013904227U;
}

void __attribute__ ((optimize(3))) pr1ntR34lPr1z3() {
    int cntr1 = 0;
    int nextIndex = syms[0];
    for (int i = 0; i < numsLength; i++) {
        if (i == nextIndex) {
            printf("%c", (char)((nums[i] / 4 - 20) ^ xorKey));
            cntr1++;
            nextIndex += syms[cntr1];
        }
    }
    printf("\n");
}


void printBanner() {
    printf("####################################\n"
           "#                                  #\n"
           "#       Welcome to the c451n0!     #\n"
           "#                                  #\n"
           "####################################\n");
}

void printTurn() {
    printf("[$] Current balance: %d c01n5\n", m0n3y);
    printf(" What do you wanna do?\n"
           "  1) Play game for 10 c01n5 - press p\n"
           "  2) Stop playing - press s\n"
           "[@]> ");
}

void __attribute__ ((optimize(3))) printPrize(char a) {
    for (size_t i = 0; i < prizeLength; i++) {
        printf("%c", a + prize_encoded[i]);
    }
    printf("\n");
}

void gameRun() {
    
    char command = 0;
    int userNumber = 0;
    unsigned int r4ndNumber = 0;
    
    seed = 0xFADECAFE;

    printf("I will give you secret for 200 c01n5 - no more, no less. Exactly 200. You see 200 - you leave casino. To do this, you must beat THE RANDOM\n");

    while (m0n3y > 0 && m0n3y < 200) {
        
        printTurn();
        scanf("%1s", &command);
        
        if (command == 'p') {
            printf("[?] Now provide number from 0 to 9: ");
            scanf("%1d", &userNumber);
            userNumber = userNumber % 10;
            r4ndNumber = seed = r4nd0m(seed) % 10;
        
            if (userNumber == r4ndNumber) {
                m0n3y += 10;
                printf("\n[+] You won!\n\n");
            }
            else {
                m0n3y -= 10;
                printf("\n[-] You lost!\n\n");
            }
        }
        else if (command == 's') {
            printf("\n[.] Ok, goodbye!\n");
            break;
        }
        else {
            printf("[x] Unknown command!\n");
        }
    }

    if (m0n3y == 200) {
        printf("Wow! Now you have enough m0n3y to buy s3cr37!!! To get it, please, give me last number you entered:");
        char a = 0;
        scanf("%1d", &a);
        printf("\n");
        printPrize(a + 'P');
    }
    else {
        printf("[$] You have %d c01n5\n", m0n3y);
    }
    
}

int main() {
    printBanner();
    gameRun();
    return 0;
}
