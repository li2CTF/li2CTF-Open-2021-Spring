#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define uint32_t u_int32_t
#define uint64_t u_int64_t

char multiplier = 10;
uint64_t xorKey = 0;
uint64_t syms[] = {2, 1, 4, 2, 4, 3, 1, 2, 5, 2, 1, 1, 1, 3, 3, 4, 3, 1, 1, 2, 1, 4, 1, 4, 1, 1, 5, 4, 5, 2, 2, 4, 1, 4, 3, 3, 5, 3, 5, 2, 5, 5, 3, 3, 5, 5, 2, 2, 1, 1, 1, 1, 2};
uint64_t numsLength = 0x109;
uint64_t nums[] = {3040365770, 3040365840, 3040365940, 3040365840, 3040365740, 3040365690, 3040365950, 3040365890, 3040365640, 3040365950, 3040365750, 3040365120, 3040365940, 3040365670, 3040365780, 3040365820, 3040365970, 3040365080, 3040365660, 3040365770, 3040365650, 3040365690, 3040365640, 3040366030, 3040366030, 3040365670, 3040365130, 3040365770, 3040365910, 3040365910, 3040365940, 3040365820, 3040365110, 3040365730, 3040365670, 3040365130, 3040365890, 3040365760, 3040365930, 3040365130, 3040365660, 3040365840, 3040365940, 3040365770, 3040365840, 3040365670, 3040365840, 3040365650, 3040365920, 3040365110, 3040365760, 3040366030, 3040365920, 3040365090, 3040365770, 3040365910, 3040365090, 3040365130, 3040365090, 3040365090, 3040365950, 3040365850, 3040365110, 3040365860, 3040365740, 3040365090, 3040365860, 3040365150, 3040365670, 3040365950, 3040365810, 3040365870, 3040365110, 3040365930, 3040365950, 3040365790, 3040365740, 3040365890, 3040365940, 3040365080, 3040365120, 3040365150, 3040365820, 3040365640, 3040365950, 3040365110, 3040365690, 3040365930, 3040365920, 3040365670, 3040365790, 3040366030, 3040365840, 3040365910, 3040365090, 3040365820, 3040366270, 3040365950, 3040365690, 3040365740, 3040365840, 3040365650, 3040365800, 3040365640, 3040365110, 3040365640, 3040365950, 3040365890, 3040365770, 3040365860, 3040365940, 3040365080, 3040365780, 3040365900, 3040365800, 3040365080, 3040365740, 3040365810, 3040365720, 3040365090, 3040365670, 3040365720, 3040365310, 3040365130, 3040365760, 3040365770, 3040365760, 3040365130, 3040365760, 3040365890, 3040365080, 3040365090, 3040366030, 3040365760, 3040365900, 3040365820, 3040365770, 3040365860, 3040365830, 3040365110, 3040365740, 3040365120, 3040365690, 3040365080, 3040365900, 3040365850, 3040365840, 3040365900, 3040365760, 3040365130, 3040365750, 3040366030, 3040365780, 3040365950, 3040365130, 3040365800, 3040365120, 3040365660, 3040365780, 3040365820, 3040365120, 3040365760, 3040365870, 3040365690, 3040365730, 3040365670, 3040365720, 3040365900, 3040365660, 3040365730, 3040365930, 3040365120, 3040365720, 3040365660, 3040365720, 3040365770, 3040365770, 3040365090, 3040365770, 3040365780, 3040365830, 3040365640, 3040366030, 3040365790, 3040365740, 3040365770, 3040365840, 3040365790, 3040365800, 3040365760, 3040365750, 3040365940, 3040365090, 3040365760, 3040365670, 3040365650, 3040365760, 3040365790, 3040365120, 3040365870, 3040365910, 3040365790, 3040365790, 3040365090, 3040365640, 3040365090, 3040365090, 3040365830, 3040365810, 3040365090, 3040365930, 3040365670, 3040365950, 3040365820, 3040365660, 3040365740, 3040366030, 3040365800, 3040365800, 3040365760, 3040366030, 3040365860, 3040365910, 3040365930, 3040365890, 3040365670, 3040365130, 3040365110, 3040365800, 3040365770, 3040365780, 3040365660, 3040365920, 3040365130, 3040365720, 3040365950, 3040365110, 3040365080, 3040365650, 3040365820, 3040365910, 3040365660, 3040365640, 3040365850, 3040365130, 3040365640, 3040365770, 3040365850, 3040365860, 3040365690, 3040365870, 3040365810, 3040365800, 3040365860, 3040365790, 3040365730, 3040365110, 3040365910, 3040365770, 3040365740, 3040365080, 3040365850, 3040366030, 3040365920, 3040365690};

void __attribute__ ((optimize(3))) print_flag() {
    int cntr = 0;
    int nextIndex = syms[0];
    for (size_t i = 0; i < numsLength; i++) {
        if (i == nextIndex) {
            printf("%c", (char)((nums[i] / 10 - 20) ^ xorKey));
            cntr++;
            nextIndex += syms[cntr];
        }
    }
    printf("\n");
}


int drop_flag(char password[], uint32_t pin) {
	xorKey = (uint64_t)pin;
	for (int32_t i = 0; i < 10; i++) {
		xorKey += password[i] * (3 * (431 * i));
	}
	print_flag();
}

// 0x11DECADE
int check_pin(uint32_t number) {
	if ((((number >> 8) & 0xFF) + 5 != 0xCF) || (((number >> 16) & 0xFF) != 0xDE) || (number >> 24 != 0x11) ||  ((number & 0xFF) != 0xDE) ) {
		return 0;
	}
	return 1;
}

// password: "F4SL3NZ0QN"
// indexes:  "0123456789"
// order:    "0852741963"
int check_password(char password[], uint32_t pin) {
	if (strlen(password) != 10) {
		return 0;
	}
	if (password[3] == password[9] - 2) { // L = N - 0x2
		if (password[0] == (pin >> 24) + 0x35) { // F = 0x11 + 0x35
			if (password[4] + 1 == password[1]) { // 3 + 0x1 = 4
				if (password[2] - 2 == password[8]) { // S - 0x2 = Q
					if (password[6] == password[0] + 0x14) { // Z = F + 0x14
						if (password[3] + 0xE == password[6]) { // L + 0xE = Z
							if (password[9] == password[5]) { // N = N
								if (password[5] == password[2] - 5) { // N = S - 0x5
									if (password[8] - 0x1E == password[4]) { // Q - 0x1E = 3
										if (password[7] == password[4] - (password[1] - password[4]) * 3) { // 0 = 3 - (0x1) * 0x3
											return 1;
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	return 0;
}

int main() {
	char password[100];
	uint32_t pin = 0;
	
	printf("Gimme PIN\n");
	scanf("%x", &pin);
	if (!check_pin(pin)) {
		printf("GTFO\n");
		return 0;
	}
	printf("Gimme password\n");
	if (scanf("%s", password) == 0) {
		printf("GTFO\n");
		return 0;
	}
	if (!check_password(password, pin)) {
		printf("GTFO\n");
		return 0;
	}
	drop_flag(password, pin);
	return 0;
}
